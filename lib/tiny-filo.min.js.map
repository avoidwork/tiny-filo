{"version":3,"sources":["tiny-filo.js"],"names":["global","factory","max","ttl","FILO","constructor","items","order","size","has","key","clear","length","delete","idx","splice","indexOf","evict","pop","get","result","item","expiry","Date","getTime","value","keys","set","push","exports","define","amd","filo","module","window"],"mappings":"AAAA;;;;;;;GAUC,UAAUA,CAAV,CAAkB,CA4ElB,QAASC,EAAT,CAAkBC,EAAM,GAAxB,CAA8BC,EAAM,CAApC,CAAuC,CACtC,MAAO,IAAIC,EAAJ,CAASF,CAAT,CAAcC,CAAd,CACP,CAED;AA/EA,KAAMC,EAAK,CACVC,YAAaH,EAAM,CAAnB,CAAsBC,EAAM,CAA5B,CAA+B,CAC9B,KAAKG,KAAL,CAAa,EADiB,CAE9B,KAAKC,KAAL,CAAa,EAFiB,CAG9B,KAAKL,GAAL,CAAWA,CAHmB,CAI9B,KAAKM,IAAL,CAAY,CAJkB,CAK9B,KAAKL,GAAL,CAAWA,CACX,CAEDM,IAAKC,CAAL,CAAU,CACT,MAAOA,KAAO,MAAKJ,KACnB,CAEDK,OAAS,CACR,KAAKL,KAAL,CAAa,EADL,CAER,KAAKC,KAAL,CAAWK,MAAX,CAAoB,CAFZ,CAGR,KAAKJ,IAAL,CAAY,CACZ,CAEDK,OAAQH,CAAR,CAAaI,EAAM,CAAC,CAApB,CAAuB,CAOtB,MANI,MAAKL,GAAL,CAASC,CAAT,CAMJ,GALC,MAAO,MAAKJ,KAAL,CAAWI,CAAX,CAKR,CAJC,KAAKH,KAAL,CAAWQ,MAAX,CAAwB,CAAC,CAAP,GAAWD,CAAX,CAAiB,KAAKP,KAAL,CAAWS,OAAX,CAAmBN,CAAnB,CAAnC,CAA4D,CAA5D,CAID,CAHC,KAAKF,IAAL,EAGD,EAAO,IACP,CAEDS,OAAS,CACR,KAAMP,GAAM,KAAKH,KAAL,CAAWW,GAAX,EAAZ,CAEA,MAAO,MAAKZ,KAAL,CAAWI,CAAX,CAHC,CAIR,KAAKF,IAAL,EACA,CAEDW,IAAKT,CAAL,CAAU,CACT,GAAIU,EAAJ,CAEA,GAAI,KAAKX,GAAL,CAASC,CAAT,CAAJ,CAAmB,CAClB,KAAMW,GAAO,KAAKf,KAAL,CAAWI,CAAX,CAAb,CAEe,CAAX,MAAKP,GAAL,EAAgBkB,EAAKC,MAAL,EAAe,GAAIC,KAAJ,GAAWC,OAAX,EAHjB,CAIjB,KAAKX,MAAL,CAAYH,CAAZ,CAJiB,CAMjBU,EAASC,EAAKI,KAEf,CAED,MAAOL,EACP,CAEDM,MAAQ,CACP,MAAO,MAAKnB,KACZ,CAEDoB,IAAKjB,CAAL,CAAUe,CAAV,CAAiB,CAChB,GAAI,KAAKhB,GAAL,CAASC,CAAT,CAAJ,CAAmB,CAClB,KAAMW,GAAO,KAAKf,KAAL,CAAWI,CAAX,CAAb,CAEAW,EAAKI,KAAL,CAAaA,CACb,CAJD,IAKgB,EAAX,MAAKvB,GAAL,EAAgB,KAAKM,IAAL,GAAc,KAAKN,GALxC,EAME,KAAKe,KAAL,EANF,CASC,KAAKV,KAAL,CAAWqB,IAAX,CAAgBlB,CAAhB,CATD,CAUC,KAAKJ,KAAL,CAAWI,CAAX,EAAkB,CAACY,OAAmB,CAAX,MAAKnB,GAAL,CAAe,GAAIoB,KAAJ,GAAWC,OAAX,GAAuB,KAAKrB,GAA3C,CAAiD,KAAKA,GAA/D,CAAoEsB,OAApE,CAVnB,CAWC,KAAKjB,IAAL,EAXD,CAcA,MAAO,KACP,CAxES,CAgFY,WAAnB,QAAOqB,QAjFO,CAmFW,UAAlB,QAAOC,OAAP,EAA+C,IAAK,EAApB,UAAOC,GAnFhC,CAoFjBD,OAAO,IAAM7B,CAAb,CApFiB,CAsFjBD,EAAOgC,IAAP,CAAc/B,CAtFG,CAkFjBgC,OAAOJ,OAAP,CAAiB5B,CAMlB,CAxFA,EAwFmB,WAAlB,QAAOiC,OAAP,CAAyClC,MAAzC,CAAgCkC,MAxFjC,C","file":"unknown","sourcesContent":["/**\r\n * Tiny FILO cache for Client or Server\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2019\r\n * @license BSD-3-Clause\r\n * @version 1.0.0\r\n */\r\n\r\n\r\n(function (global) {\r\n\tclass FILO {\r\n\t\tconstructor (max = 0, ttl = 0) {\r\n\t\t\tthis.items = {};\r\n\t\t\tthis.order = [];\r\n\t\t\tthis.max = max;\r\n\t\t\tthis.size = 0;\r\n\t\t\tthis.ttl = ttl;\r\n\t\t}\r\n\r\n\t\thas (key) {\r\n\t\t\treturn key in this.items;\r\n\t\t}\r\n\r\n\t\tclear () {\r\n\t\t\tthis.items = {};\r\n\t\t\tthis.order.length = 0;\r\n\t\t\tthis.size = 0;\r\n\t\t}\r\n\r\n\t\tdelete (key, idx = -1) {\r\n\t\t\tif (this.has(key)) {\r\n\t\t\t\tdelete this.items[key];\r\n\t\t\t\tthis.order.splice(idx > -1 ? idx : this.order.indexOf(key), 1);\r\n\t\t\t\tthis.size--;\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tevict () {\r\n\t\t\tconst key = this.order.pop();\r\n\r\n\t\t\tdelete this.items[key];\r\n\t\t\tthis.size--;\r\n\t\t}\r\n\r\n\t\tget (key) {\r\n\t\t\tlet result;\r\n\r\n\t\t\tif (this.has(key)) {\r\n\t\t\t\tconst item = this.items[key];\r\n\r\n\t\t\t\tif (this.ttl > 0 && item.expiry >= new Date().getTime()) {\r\n\t\t\t\t\tthis.delete(key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = item.value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tkeys () {\r\n\t\t\treturn this.order;\r\n\t\t}\r\n\r\n\t\tset (key, value) {\r\n\t\t\tif (this.has(key)) {\r\n\t\t\t\tconst item = this.items[key];\r\n\r\n\t\t\t\titem.value = value;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.max > 0 && this.size === this.max) {\r\n\t\t\t\t\tthis.evict();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.order.push(key);\r\n\t\t\t\tthis.items[key] = {expiry: this.ttl > 0 ? new Date().getTime() + this.ttl : this.ttl, value};\r\n\t\t\t\tthis.size++;\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction factory (max = 1000, ttl = 0) {\r\n\t\treturn new FILO(max, ttl);\r\n\t}\r\n\r\n\t// Node, AMD & window supported\r\n\tif (typeof exports !== \"undefined\") {\r\n\t\tmodule.exports = factory;\r\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\r\n\t\tdefine(() => factory);\r\n\t} else {\r\n\t\tglobal.filo = factory;\r\n\t}\r\n}(typeof window !== \"undefined\" ? window : global));\r\n"]}
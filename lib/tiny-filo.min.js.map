{"version":3,"sources":["tiny-filo.js"],"names":["global","factory","max","ttl","FILO","constructor","first","items","last","size","has","key","clear","delete","item","prev","next","evict","get","result","expiry","Date","getTime","value","keys","Object","set","exports","define","amd","filo","module","window"],"mappings":"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","file":"unknown","sourcesContent":["/**\r\n * Tiny FILO cache for Client or Server\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2019\r\n * @license BSD-3-Clause\r\n * @version 1.0.6\r\n */\r\n\r\n\r\n(function (global) {\r\n\tclass FILO {\r\n\t\tconstructor (max = 0, ttl = 0) {\r\n\t\t\tthis.first = null;\r\n\t\t\tthis.items = {};\r\n\t\t\tthis.last = null;\r\n\t\t\tthis.max = max;\r\n\t\t\tthis.size = 0;\r\n\t\t\tthis.ttl = ttl;\r\n\t\t}\r\n\r\n\t\thas (key) {\r\n\t\t\treturn key in this.items;\r\n\t\t}\r\n\r\n\t\tclear () {\r\n\t\t\tthis.first = null;\r\n\t\t\tthis.items = {};\r\n\t\t\tthis.last = null;\r\n\t\t\tthis.size = 0;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tdelete (key) {\r\n\t\t\tif (this.has(key)) {\r\n\t\t\t\tconst item = this.items[key];\r\n\r\n\t\t\t\tdelete this.items[key];\r\n\t\t\t\tthis.size--;\r\n\r\n\t\t\t\tif (item.prev !== null) {\r\n\t\t\t\t\titem.prev.next = item.next;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.next !== null) {\r\n\t\t\t\t\titem.next.prev = item.prev;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.first === item) {\r\n\t\t\t\t\tthis.first = item.next;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.last === item) {\r\n\t\t\t\t\tthis.last = item.prev;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tevict () {\r\n\t\t\tconst item = this.last;\r\n\r\n\t\t\tdelete this.items[item.key];\r\n\t\t\tthis.last = item.prev;\r\n\t\t\tthis.last.next = null;\r\n\t\t\tthis.size--;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tget (key) {\r\n\t\t\tlet result;\r\n\r\n\t\t\tif (this.has(key)) {\r\n\t\t\t\tconst item = this.items[key];\r\n\r\n\t\t\t\tif (this.ttl > 0 && item.expiry <= new Date().getTime()) {\r\n\t\t\t\t\tthis.delete(key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = item.value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tkeys () {\r\n\t\t\treturn Object.keys(this.items);\r\n\t\t}\r\n\r\n\t\tset (key, value) {\r\n\t\t\tif (this.has(key)) {\r\n\t\t\t\tconst item = this.items[key];\r\n\r\n\t\t\t\titem.value = value;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.max > 0 && this.size === this.max) {\r\n\t\t\t\t\tthis.evict();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst item = this.items[key] = {\r\n\t\t\t\t\texpiry: this.ttl > 0 ? new Date().getTime() + this.ttl : this.ttl,\r\n\t\t\t\t\tkey: key,\r\n\t\t\t\t\tprev: this.last,\r\n\t\t\t\t\tnext: null,\r\n\t\t\t\t\tvalue\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (++this.size === 1) {\r\n\t\t\t\t\tthis.first = item;\r\n\t\t\t\t\tthis.last = item;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.last.next = item;\r\n\t\t\t\t\tthis.last = item;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction factory (max = 1000, ttl = 0) {\r\n\t\treturn new FILO(max, ttl);\r\n\t}\r\n\r\n\t// Node, AMD & window supported\r\n\tif (typeof exports !== \"undefined\") {\r\n\t\tmodule.exports = factory;\r\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\r\n\t\tdefine(() => factory);\r\n\t} else {\r\n\t\tglobal.filo = factory;\r\n\t}\r\n}(typeof window !== \"undefined\" ? window : global));\r\n"]}